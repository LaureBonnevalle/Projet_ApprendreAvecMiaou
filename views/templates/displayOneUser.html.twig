{% extends "layout.html.twig" %}

{# Titre de la page #}
{% block title %}
         | DashboardAdmin
{% endblock %}

{% block body %}

        {% block content %}
    
            {% block error %}
            {% endblock %}
            <section id="oneuser">
<div class="user-panel">
  <div class="card">
    <div class="card-header">
      Gestion de l'utilisateur #{{ id }}
    </div>

    <div class="card-body">
      <table>
        <tbody>
          <tr>
            <th>ID</th>
            <td>{{ id }}</td>
          </tr>

          <tr>
            <th>Email</th>
            <td>{{ email }}</td>
          </tr>

          <tr>
            <th>Prénom</th>
            <td>{{ firstname }}</td>
          </tr>

          <tr>
            <th>Avatar</th>
            <td>
              <div class="action-group">
                <select class="select-sm" style="width: 200px;" onchange="updateAvatar(this)">
                  {% for avatarOption in avatars %}
                    <option value="{{ avatarOption.id }}"
                      {{ avatar and avatar.id == avatarOption.id ? 'selected' : '' }}>
                      {{ avatarOption.name }}
                    </option>
                  {% endfor %}
                </select>
                <input type="hidden" name="user_id" value="{{ id }}">
              </div>
            </td>
          </tr>

          <tr>
            <th>Newsletter</th>
            <td>
              <div class="action-group">
                {% if newsletter == 1 %}
        <span class="newsletter-badge active" id="newsletter-badge-{{ id }}">Abonné</span>
        <button class="btn-toggle"
                onclick="toggleNewsletter({{ id }}, 0)"
                id="newsletter-button-{{ id }}">
          Désabonner
        </button>
      {% else %}
        <span class="newsletter-badge inactive" id="newsletter-badge-{{ id }}">Non abonné</span>
        <button class="btn-toggle"
                onclick="toggleNewsletter({{ id }}, 1)"
                id="newsletter-button-{{ id }}">
          Abonner
        </button>
      {% endif %}
              </div>
              <div id="newsletter-message-{{ id }}" class="message" aria-live="polite"></div>
            </td>
          </tr>

          <tr>
            <th>Rôle</th>
            <td>
              <div class="action-group">
                <span class="badge role {{ role == 2 ? 'admin' : 'user' }}"
                      id="role-badge-{{ id }}">
                  {{ role == 2 ? 'Administrateur' : 'Utilisateur' }}
                </span>
                <select class="select-sm" style="width: 200px;"
                        onchange="updateRole({{ id }}, this.value)"
                        id="role-select-{{ id }}">
                  <option value="1" {{ role == 1 ? 'selected' : '' }}>Utilisateur</option>
                  <option value="2" {{ role == 2 ? 'selected' : '' }}>Administrateur</option>
                </select>
              </div>
              <div id="role-message-{{ id }}" class="message" aria-live="polite"></div>
            </td>
          </tr>

          <tr>
            <th>Statut</th>
            <td>
              <div class="action-group">
                {% if statut == 1 %}
        <span class="status-badge active" id="status-badge-{{ id }}">Actif</span>
        <button class="btn-toggle"
                onclick="toggleStatus({{ id }}, 0)"
                id="status-button-{{ id }}">
          Désactiver
        </button>
      {% else %}
        <span class="status-badge inactive" id="status-badge-{{ id }}">Inactif</span>
        <button class="btn-toggle"
                onclick="toggleStatus({{ id }}, 1)"
                id="status-button-{{ id }}">
          Activer
        </button>
      {% endif %}
              </div>
              <div id="status-message-{{ id }}" class="message" aria-live="polite"></div>
            </td>
          </tr>
          <tr>
            <th>Mot de passe</th>
            <td>
              <div class="action-group">
                <button 
                  type="button" 
                  class="btn btn-sm btn-outline-warning btn-action"
                  id="resetPasswordBtn"
                  data-user-id="{{ id }}"
                  onclick="resetPassword({{ id }})">
                  <i class="fas fa-key"></i> Réinitialiser le mot de passe
                </button>
              </div>
              <div id="resetPasswordMsg-{{ id }}" class="message" aria-live="polite"></div>
              {# Hidden CSRF token for the request #}
              <input type="hidden" id="csrf-token-{{ id }}" value="{{ csrf_token }}">
            </td>
          </tr>
          </tr>

          <tr>
            <th>Créé le</th>
            <td>{{ createdAt|date('d/m/Y H:i') }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="card-footer">
      <a href="?route=allUsers" class="btn-link">Retour à la liste des utilisateurs</a>
    </div>
  </div>
</div>
</section>
<style>
                    section {
                        font-family: 'Comic Sans MS', 'Raleway', cursive;
                    }
                        #search {
                            border-radius 30px;
                        }

                        table {
                            margin-top: 5vh; /* Ajoute un espace de 5 cm avant la table */
                            border-collapse: collapse;
                            width: 100%;
                            border-radius: 30px;
                        }

                        th, td {
                            border: 1px solid black;
                            padding: 10px;
                            text-align: left;
                        }

                        th {
                            background-color: #090909ff;
                            color: white;
                            border: 1px solid white;
                        }
                        td {
                            background-color: white;
                        }
            </style>

        {% endblock %}
{% endblock %}