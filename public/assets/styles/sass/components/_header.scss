@use '../abstracts/varcolors';
@use '../abstracts/mixins';
@use 'sass:color'; // ✅ Import du module color pour les fonctions modernes

// ====================================
// HEADER PRINCIPAL
// ====================================
#header {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 18vh;
    background-color: varcolors.$noir;
    z-index: varcolors.$z-header;
    padding: 1rem clamp(1rem, 3vw, 2rem);

    .rect {
        position: relative;
        background-image: url('../../img/Miaou/backgroundHeader.jpg');
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        border: 5px solid transparent;
        border-image: linear-gradient(135deg, #FFC0CB 0%, #FF1493 30%, #B239ED 70%, #8B00FF 100%) 1;
        border-radius: 20px;
        padding: clamp(1rem, 2vw, 1.5rem);
        display: flex;
        align-items: center;
        gap: clamp(0.5rem, 2vw, 1vw);
        height: 10vh;
        width: 87vw;
        overflow: hidden;
        margin-bottom: 1rem;
        
        &::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(178, 57, 237, 0.1) 100%);
            pointer-events: none;
        }

        > * {
            position: relative;
            z-index: 1;
        }
    }

    .header-left {
        display: flex;
        align-items: center;
        gap: clamp(0.8rem, 2.5vw, 1.2rem);
        flex: 1;
        margin-top: 1vh;

        .avatar-container {
            margin: 1vh;
            flex-shrink: 0;

            .avatar {
                width: clamp(70px, 15vw, 100px);
                height: clamp(70px, 14vw, 100px);
                border-radius: 50%;
                object-fit: cover;
            }
        }

        .site-title {
            font-family: 'Comic Sans MS', 'Raleway', cursive;
            font-size: clamp(2vh, 3.8vw, 5vh);
            font-weight: bold;
            color: varcolors.$noir;
            margin: 0;
            text-shadow: 
                2px 2px 0 varcolors.$blanc,
                -1px -1px 0 varcolors.$blanc,
                1px -1px 0 varcolors.$blanc,
                -1px 1px 0 varcolors.$blanc,
                3px 3px 6px rgba(0, 0, 0, 0.3);
            line-height: 1.2;
        }
    }

    .header-actions {
        display: flex;
        flex-direction: column;
        gap: 0.8rem;
        align-items: stretch;
        min-width: clamp(30px, 20vw, 200px);
        min-height: clamp(2vh, 8vh, 300px);
        margin-right: 30px;
        margin-bottom: 1vh;

        .action-button {
            @include mixins.button-3d(varcolors.$rouge-main, varcolors.$rouge-dark, varcolors.$noir);
            font-family: 'Comic Sans MS', 'Raleway', cursive;
            font-size: clamp(0.9rem, 1.5vw, 1.1rem);
            padding: clamp(0.4rem, 0.5vw, 0.8rem) clamp(1rem, 1vw, 1.5rem);
            justify-content: center;
            text-align: center;
            white-space: nowrap;
            border-width: 1px;
            box-shadow: 4px 6px 0px varcolors.$rouge-dark;
            width: auto;
            min-width: unset;
            max-width: unset;

            &:hover {
                box-shadow: 3px 4px 0px varcolors.$rouge-dark;
            }

            &:active {
                box-shadow: 1px 2px 0px varcolors.$rouge-dark;
            }

            i {
                font-size: 1.1em;
            }

            &.btn-register {
                background-color: varcolors.$orange-main;
                border-color: varcolors.$noir;
                box-shadow: 4px 6px 0px varcolors.$orange-border;

                &:hover {
                    box-shadow: 3px 4px 0px varcolors.$orange-border;
                }

                &:active {
                    box-shadow: 1px 2px 0px varcolors.$orange-border;
                }
            }
        }
    }

    .burger-btn {
        position: absolute;
        bottom: 3vh;
        left: 1vh;
        width: 0;
        height: 0;
        cursor: pointer;
        z-index: 10;

        &:hover {
            transform: translate(2px, 2px);
        }

        &:active {
            transform: translate(3px, 3px);
        }

        @include mixins.breakpoint(medium-large) {
            display: none;
        }
    }

    .cache {
        display: none;
        pointer-events: none;
        
        &.active {
            display: none;
            pointer-events: none;
        }
    }
}

@include mixins.breakpoint(mobile) {
    .header-actions .action-button span {
        display: none;
    }

    .header-actions .action-button {
        padding: 0.6rem;
        min-width: auto;
    }
}

// ====================================
// NAVIGATION
// ====================================
#nav {
    position: fixed;
    top: 0;
    left: -100%;
    width: auto;
    max-width: 320px;
    height: auto;
    background-color: varcolors.$noir;
    box-shadow: 5px 0 20px rgba(0, 0, 0, 0.5);
    z-index: varcolors.$z-nav;
    transition: left varcolors.$transition-slow;
    overflow-y: auto;
    padding-top: clamp(140px, 25vh, 180px);

    &.open {
        left: 0;
    }

    .nav-links-container,
    #nav-links-container,
    #navUser-links-container {
        list-style: none;
        padding: 1rem 0;
        margin: 0;
        font-family: 'Comic Sans MS', 'Raleway', cursive;

        li {
            margin: 0;

            a, span {
                display: flex;
                align-items: center;
                padding: 1.2rem 1.5rem;
                color: varcolors.$blanc;
                text-decoration: none;
                font-size: 1.1rem;
                transition: all varcolors.$transition-normal;
                position: relative;

                &::after {
                    content: '';
                    position: absolute;
                    bottom: 0;
                    left: 1px;
                    right: 1px;
                    height: 5px;
                    transition: all varcolors.$transition-normal;
                }

                &:hover {
                    background-color: varcolors.$noir-menu;
                    padding-left: 2rem;

                    &::after {
                        left: 0.5rem;
                        right: 0.5rem;
                        height: 4px;
                    }
                }
            }

            &:nth-child(1) a::after { background-color: varcolors.$color-accueil; }
            &:nth-child(2) a::after { background-color: varcolors.$color-contact; }
            &:nth-child(3) a::after { background-color: varcolors.$color-histoires; }
            &:nth-child(4) a::after { background-color: varcolors.$color-coloriages; }
            &:nth-child(5) a::after { background-color: varcolors.$color-jeux; }

            span.disabled {
                opacity: 0.5;
                cursor: not-allowed;

                &:hover {
                    background-color: transparent;
                    padding-left: 1.5rem;
                }
            }
        }
    }

    // ✅ Navigation desktop COLLÉE au header
    @include mixins.breakpoint(medium-large) {
        position: fixed; // ✅ Fixed au lieu de static
        top: 23vh; // ✅ Collé juste sous le header
        left: 0;
        width: 100%;
        max-width: none;
        height: auto;
        background-color: varcolors.$noir; // ✅ Fond noir restauré
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        padding-top: 0;
        padding-bottom: 1rem;
        z-index: calc(varcolors.$z-header - 1); // ✅ Juste en dessous du header

        .nav-links-container,
        #nav-links-container,
        #navUser-links-container {
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
            padding: 2vh;
            padding-bottom: 1vh;
            gap: clamp(0.8rem, 2vw, 1.5rem);
            flex-wrap: wrap;
            font-family: 'Comic Sans MS', 'Raleway', cursive;
            font-weight: bold;
            text-shadow: 
                2px 2px 0 varcolors.$blanc,
                -1px -1px 0 varcolors.$blanc,
                1px -1px 0 varcolors.$blanc,
                -1px 1px 0 varcolors.$blanc,
                3px 3px 6px rgba(0, 0, 0, 0.3);

            li {
                a, span {
                    padding: 0.8rem 2rem;
                    border-radius: varcolors.$radius-round;
                    border: 1px solid varcolors.$noir;
                    box-shadow: 4px 6px 0px;
                    font-size: clamp(0.9rem, 1.5vw, 1.1rem);
                    color: varcolors.$noir;

                    &::after {
                        display: none;
                    }

                    &:hover {
                        transform: translate(2px, 2px);
                        padding-left: 2rem;
                    }

                    &:active {
                        transform: translate(3px, 3px);
                    }
                }

                // ✅ Utilisation de color.adjust() au lieu de darken()
                &:nth-child(1) a {
                    background-color: varcolors.$color-accueil;
                    box-shadow: 4px 6px 0px varcolors.$color-accueil-dark;
                    &:hover { box-shadow: 3px 4px 0px varcolors.$color-accueil-dark; }
                    &:active { box-shadow: 1px 2px 0px varcolors.$color-accueil-dark; }
                }

                &:nth-child(2) a {
                    background-color: varcolors.$pink-main;
                    box-shadow: 4px 6px 0px varcolors.$pink-dark;
                    &:hover { box-shadow: 3px 4px 0px varcolors.$pink-dark; }
                    &:active { box-shadow: 1px 2px 0px varcolors.$pink-dark; }
                }

                &:nth-child(3) a {
                    background-color: varcolors.$color-histoires;
                    box-shadow: 4px 6px 0px varcolors.$color-histoires-dark;
                    &:hover { box-shadow: 3px 4px 0px varcolors.$color-histoires-dark; }
                    &:active { box-shadow: 1px 2px 0px varcolors.$color-histoires-dark; }
                }

                &:nth-child(4) a {
                    background-color: varcolors.$color-coloriages;
                    box-shadow: 4px 6px 0px color.adjust(varcolors.$color-coloriages, $lightness: -15%);
                    color: varcolors.$noir;
                    &:hover { box-shadow: 3px 4px 0px color.adjust(varcolors.$color-coloriages, $lightness: -15%); }
                    &:active { box-shadow: 1px 2px 0px color.adjust(varcolors.$color-coloriages, $lightness: -15%); }
                }

                &:nth-child(5) a {
                    background-color: varcolors.$color-jeux;
                    box-shadow: 4px 6px 0px color.adjust(varcolors.$color-jeux, $lightness: -15%);
                    color: varcolors.$noir;
                    &:hover { box-shadow: 3px 4px 0px color.adjust(varcolors.$color-jeux, $lightness: -15%); }
                    &:active { box-shadow: 1px 2px 0px color.adjust(varcolors.$color-jeux, $lightness: -15%); }
                }
            }
        }
    }
}

// ====================================
// ESPACEMENT ET FOND DU BODY
// ====================================
body {
    padding-top: clamp(150px, 20vh, 200px);
    background: 
        url('../img/Miaou/nuages.png') repeat-x center top,
        linear-gradient(180deg, #87CEEB 0%, #E0F6FF 50%, #87CEEB 100%);
    background-size: auto 100%, 100% 100%;
    min-height: 100vh;

    @include mixins.breakpoint(medium-large) {
        padding-top: clamp(280px, 38vh, 340px); // ✅ Augmenté pour compenser nav fixe
    }
}

main {
    padding-top:-24vh;
    margin-top:-10vh;
    background: transparent;
    min-height: calc(100vh - 200px);
}